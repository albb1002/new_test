<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<link rel="stylesheet" href="css/common.css" />
		<link rel="stylesheet" href="css/module.css" />
		<link rel="stylesheet" href="css/address.css" />
		<link rel="stylesheet" href="css/changeCity.css" />
		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=A93f71cffe8095a54c645a7cb0139fe4"></script>
	</head>
	<body>
		<div class="wrap address">
			
			<!--搜索-->
			<div class="pd-tb-5 search">
				<div class="search-text">
					<input type="text" placeholder="请输入自提门店" class="br-3" id="address_info"/>
				</div>
				<div class="relative overhidden"><button type="button" id="search">搜索</button></div>
			</div>
			<!--搜索--end-->
			
			<!--地图-->
			<div id="map" class="map">
			</div>
			<!--地图--end-->
			
			<div class="map-list">
				<div class="pd-bottom-3">
					<img src="img/map.png">世贸总店<span class="tip">【推荐】</span>
				</div>
				<div class="t-rgb-153 font-size-8">
					厦门市思明区软件园二期观日路54号楼
				</div>
			</div>
			<div class="map-list">
				<div class="pd-bottom-3">
					<img src="img/map.png">万达店
				</div>
				<div class="t-rgb-153 font-size-8">
					厦门市思明区软件园二期观日路54号楼
				</div>
			</div>
			
			<div class="map-list">
				<div class="pd-bottom-3">
					<img src="img/map.png">下达点
				</div>
				<div class="t-rgb-153 font-size-8">
					厦门市思明区软件园二期观日路54号楼
				</div>
			</div>
			
			<div id="result">
				
			</div>
			<div id="r-result">
				
			</div>
		</div>
		
		<script type="text/javascript" src="js/font-initial.js" ></script>
		
		<script type="text/javascript">
		
		var address_info = document.getElementById("address_info");
		var search = document.getElementById("search");
		search.onclick = function(){
			var local = {
				onSearchComplete:function(results){
					if (local.getStatus() == BMAP_STATUS_SUCCESS){
						var s = [];
						for (var i = 0; i < results.getCurrentNumPois(); i ++){
							s.push(results.getPoi(i).title + ", " + results.getPoi(i).address);
						}
						document.getElementById("result").innerHTML = s.join("<br/>");
					}
				}
			};
			
			var local = new BMap.LocalSearch(map,local);
			local.search(address_info.value)
			
//			搜索方式二
			var locals = new BMap.LocalSearch(map, {
				renderOptions: {map: map, panel: "r-result"}
			});
			locals.search(address_info.value)
		}
		
		
 var map = new BMap.Map("map");
    var point = new BMap.Point(118.191627,24.489118);//创建坐标；初始经纬度
    map.centerAndZoom(point,12);//创建地图级别
    
//  点击地址的提示信息
    var data_info = [[118.191627,24.489118,"地址:福建省厦门市思明区软件园二期观日路54号之502"]]
    
    var opts = {
				width : 200,     // 信息窗口宽度
				height: 60,     // 信息窗口高度
				title : "" , // 信息窗口标题
				enableMessage:true,//设置允许信息窗发送短息
				offset   : new BMap.Size(-5, -18)    //设置文本偏移量
			   };
	for(var i=0;i<data_info.length;i++){
		var marker = new BMap.Marker(new BMap.Point(data_info[i][0],data_info[i][1]));  // 创建标注
		var content = data_info[i][2];
		map.addOverlay(marker);               // 将标注添加到地图中
		addClickHandler(content,marker);
	}
	
	function addClickHandler(content,marker){
		marker.addEventListener("click",function(e){
			openInfo(content,e)}
		);
	}
	function openInfo(content,e){
		var p = e.target;
		var point = new BMap.Point(p.getPosition().lng, p.getPosition().lat);
		var infoWindow = new BMap.InfoWindow(content,opts);  // 创建信息窗口对象 
		map.openInfoWindow(infoWindow,point); //开启信息窗口
	}
    //  点击地址的提示信息--end--
    
    
    //地图放大缩小控件
	var op = {type: BMAP_NAVIGATION_CONTROL_SMALL}   //放大 缩小的标注pc端位于左上角，移动端右下角 
	map.addControl(new BMap.NavigationControl(op));
	 //地图放大缩小控件---end--
	
	//初始的提示信息--里我最近
	var lab={
		position : point,    // 指定文本标注所在的地理位置
	 	 offset   : new BMap.Size(-33, -10)    //设置文本偏移量
	}
	
    var label = new BMap.Label("离我最近", lab);
    label.setStyle({
			 //color : "red",
			 fontSize : "12px",
			 height : "20px",
			 lineHeight : "20px",
			 fontFamily:"微软雅黑",
			 border:"1px solid rgb(153,153,153)",
			 padding:"0 5px"
		 });
    map.addOverlay(label);   
    //初始的提示信息----end
    
    
    map.enableScrollWheelZoom();   //启用滚轮放大缩小，默认禁用
	map.enableContinuousZoom();    //启用地图惯性拖拽，默认禁用
	
	
</script>
	</body>
</html>
